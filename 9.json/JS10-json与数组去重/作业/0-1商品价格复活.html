<!DOCTYPE HTML>
<HTML>

<HEAD>
    <meta charset="utf-8" />
    <meta name="generator" content="editplus" />
    <meta name="author" content="" />
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <TITLE>New Document</TITLE>
</HEAD>

<BODY>输入原始文本(空格隔开)：
    <br>
    <textarea style="width:300px; height:200px;" id="txt1">冰红茶-3元,冰绿茶-2.5元,橙汁-1.5元,葡萄汁-5毛,柠檬汁-1.5元,芒果汁-30毛,柠檬汁-1.5元,柠檬汁-1.5元,柠檬汁-1.5元,柠檬汁-1.5元</textarea>
    <br>
    <br>
    <input type="button" value="变" id="btn1" />
    <br>
    <br>这里输出结果：
    <br>
    <textarea style="width:300px; height:200px;" id="txt2"></textarea>
    <script type="text/javascript">
        window.onload = function() {
            var oBtn = $('btn1');
            var oTxt1 = $('txt1');
            var oTxt2 = $('txt2');
            oBtn.onclick = function() {
                var arr = oTxt1.value.split(",");
                console.log(arr);
                var json = {};
                for (var i = 0; i < arr.length; i++) {
                    var arr2 = arr[i].split("-");
                    console.log(arr2);
                    var key = arr2[0];
                    if (arr2[1].indexOf('元') != -1) {
                        var value = parseFloat(arr2[1]);
                    } 
					else {
                        var value = parseFloat(arr2[1]) / 10;
                    }
                    if (json[key]) {//如果json的这个键值存在。就自加一
                        json[key].count++;
                        json[key].sum += value;
                    } else {
                        json[key] = {
                            count: 1,
                            sum: value
                        };
                    }
                }
                var arr3 = [];
                var result = 0;
                for (var key in json) {
                    arr3.push(key + '...' + json[key].count + '￥' + json[key].sum);
                    result += json[key].sum;
                }
                arr3.push('总价' + result);
                console.log(arr3);
                oTxt2.value = arr3.join('\n');
            }

            function $(id) {
                return document.getElementById(id);
            }
        }
         //		window.onload=function(){
         //	var oT1=document.getElementById('txt1');
         //	var oT2=document.getElementById('txt2');
         //	var oBtn=document.getElementById('btn1');	
         //	oBtn.onclick=function(){
         //		var arr=oT1.value.split(',');	//['冰红茶-3元','..','...']	A
         //		//页面要的 '冰红茶(1个) ￥3','..','..'		D
         //		//['冰红茶(1个) ￥3','','']				C
         //		//[{冰红茶:{count:1,sum:3}},{},{}]		C
         //		//{冰红茶:{count:1,sum:3},{...},{}}		B
         //		
         //		var json={};
         //		for(var i=0;i<arr.length;i++){
         //			var arr2=arr[i].split('-');	//[冰红茶,3元]
         //			var key=arr2[0];
         //			
         //			if(arr2[1].indexOf('元') != -1){
         //				var price=parseFloat(arr2[1]);	
         //			}else{
         //				var price=parseFloat(arr2[1])/10;	
         //			}
         //			
         //			if(json[key]){
         //				json[key].count++;
         //				json[key].sum+=price;
         //			}else{
         //				json[key]={count:1,sum:price};	
         //			}
         //		}
         //		
         //		var arr3=[];
         //		var result=0;
         //		for(var key in json){
         //			arr3.push(key+'('+json[key].count+'个) ￥'+json[key].sum);	
         //			result+=json[key].sum;
         //		}
         //		arr3.push('总价: ￥'+result);
         //		
         //		console.log(arr3);
         //		
         //		oT2.value=arr3.join('\n');
         //	};
         //};
    </script>
</BODY>

</HTML>